{% extends 'base.html' %}

{% block title %}
    {{ album.title }}
{% endblock %}

{% block content %}
    <div class="d-flex justify-content-center text-center mb-4">
        <div>
            {# Album title #}
            <h1 class="display-2 text-primary">{{ album.title }}</h1>
            {# by Artist/s or/and Music group/s #}
            {% if album_artists or album_music_groups %}
                <p class="fs-5">by
                    {% for artist in album_artists %}
                        <a href="{% url 'contributor' artist.pk %}" class="hover-link">
                            {{ artist }}
                        </a>{% if not forloop.last or album_music_groups %}, {% endif %}
                    {% endfor %}
                    {% for group in album_music_groups %}
                        <a href="{% url 'music-group' group.pk %}" class="hover-link">
                            {{ group }}
                        </a>{% if not forloop.last %}, {% endif %}
                    {% endfor %}
                </p>
            {% endif %}
        </div>
    </div>
    <div class="p-5 text-center bg-body-secondary">
        <div class="container-fluid">
            <div class="row d-flex align-items-start">
                {# Album cover #}
                {% if album.cover_image %}
                    <div class="col-12 col-md-4 text-center mb-4">
                        <img src="{{ album.cover_image.url }}"
                             alt="Cover image for album {{ album.title }}"
                             class="img-fluid rounded shadow"
                             style="max-width: 300px; height: auto;">
                    </div>
                {% endif %}
                {# Song/s #}
                {% if songs %}
                    <div class="col-12 col-md-4 text-start">
                        <p><span class="header-custom">Songs:</span></p>
                        <ol>
                            {% for song in songs %}
                                <li>
                                    <a href="{% url 'song' song.pk %}" class="hover-link">{{ song.title }}</a>
                                </li>
                            {% empty %}
                                <li>No songs found for this album.</li>
                            {% endfor %}
                        </ol>
                    </div>
                {% endif %}
                <div class="col-12 col-md-4 text-start">
                    {# Genre/s #}
                    {% if genres %}
                        <p><span class="header-custom">{{ genre_label }}:</span>
                            {% for g in genres %}
                                <span class="badge hover-badge">{{ g.name }}</span>
                            {% empty %}
                                No genres
                            {% endfor %}
                        </p>
                    {% endif %}
                    {# Released #}
                    {% if album.released %}
                        <p><span class="header-custom">Released year:</span> {{ album.released.year }}</p>
                    {% endif %}
                    {# Duration #}
                    {% if total_duration %}
                        <p><span class="header-custom">Total duration:</span> {{ total_duration }}</p>
                    {% endif %}
                    {# Language/s #}
                    {% if languages %}
                        <p><span class="header-custom">{{ language_label }}:</span>
                            {% for l in languages %}
                                {{ l.name }}{% if not forloop.last %}, {% endif %}
                            {% empty %}
                                No languages
                            {% endfor %}
                        </p>
                    {% endif %}
                </div>
            </div>
        </div>
        <div class="row mt-4">
            <div class="col-12 text-start">
                {# Performer/s #}
                {% if contributors_by_category.performer %}
                    <p>
                        <span class="header-custom">Performers:</span>
                        {% for contributor, roles in contributors_by_category.performer %}
                            <span class="d-inline-block mb-1">
                                <a href="{% url 'contributor' contributor.pk %}"
                                   class="hover-link">{{ contributor }}</a>
                                ({{ roles|join:", " }}){% if not forloop.last %}, {% endif %}
                            </span>
                        {% endfor %}
                    </p>
                {% endif %}
                {# Writer/s #}
                {% if contributors_by_category.writer %}
                    <p>
                        <span class="header-custom">Writers:</span>
                        {% for contributor, roles in contributors_by_category.writer %}
                            <span class="d-inline-block mb-1">
                                <a href="{% url 'contributor' contributor.pk %}"
                                   class="hover-link">{{ contributor }}</a>
                                ({{ roles|join:", " }}){% if not forloop.last %}, {% endif %}
                            </span>
                        {% endfor %}
                    </p>
                {% endif %}
                {# Producer/s #}
                {% if contributors_by_category.producer %}
                    <p>
                        <span class="header-custom">Producers:</span>
                        {% for contributor, roles in contributors_by_category.producer %}
                            <span class="d-inline-block mb-1">
                                <a href="{% url 'contributor' contributor.pk %}"
                                   class="hover-link">{{ contributor }}</a>
                                ({{ roles|join:", " }}){% if not forloop.last %}, {% endif %}
                            </span>
                        {% endfor %}
                    </p>
                {% endif %}
                {# Publisher/s #}
                {% if contributors_by_category.publisher %}
                    <p>
                        <span class="header-custom">Publishers:</span>
                        {% for contributor, roles in contributors_by_category.publisher %}
                            <span class="d-inline-block mb-1">
                                <a href="{% url 'contributor' contributor.pk %}"
                                   class="hover-link">{{ contributor }}</a>
                                ({{ roles|join:", " }}){% if not forloop.last %}, {% endif %}
                            </span>
                        {% endfor %}
                    </p>
                {% endif %}
                {# Other contributor/s #}
                {% if contributors_by_category.other %}
                    <p>
                        <span class="header-custom">Other contributors:</span>
                        {% for contributor, roles in contributors_by_category.other %}
                            <span class="d-inline-block mb-1">
                                <a href="{% url 'contributor' contributor.pk %}"
                                   class="hover-link">{{ contributor }}</a>
                                ({{ roles|join:", " }}){% if not forloop.last %}, {% endif %}
                            </span>
                        {% endfor %}
                    </p>
                {% endif %}
                {# Music Group/s #}
                {% if groups_by_role %}
                    <p>
                        <span class="header-custom">Music Groups:</span>
                        {% for role, groups in groups_by_role.items %}
                            {% for group in groups %}
                                <span class="d-inline-block mb-1">
                                    <a href="{% url 'music-group' group.pk %}"
                                       class="hover-link">{{ group }}</a> ({{ role }})
                                    {% if not forloop.last or not forloop.parentloop.last %}, {% endif %}
                                </span>
                            {% endfor %}
                        {% endfor %}
                    </p>
                {% endif %}
                {# Summary #}
                {% if album.summary %}
                    <div class="text-start text-justify my-4">
                        <p><span class="header-custom">Summary:</span></p>
                        {{ album.summary|linebreaks }}
                    </div>
                {% endif %}
            </div>
        </div>
    </div>
{% endblock %}
